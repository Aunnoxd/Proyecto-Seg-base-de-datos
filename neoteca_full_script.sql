-- SCRIPT GENERADO AUTOMÁTICAMENTE PARA NEOTECA
-- FECHA: DICIEMBRE 2025

-- 1. LIMPIEZA INICIAL
BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE LOG_SEGURIDAD CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE DESCARGA CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE LEE CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE ASIGNACION CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE LIBRO CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE MATERIA CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE ESTUDIANTE CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE PROFESOR CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE TUTOR CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE GRADO CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE USUARIO CASCADE CONSTRAINTS';
EXCEPTION WHEN OTHERS THEN NULL; END;
/

-- 2. CREACIÓN DE TABLAS

  CREATE TABLE "SYSTEM"."USUARIO" 
   (	"ID_USUARIO" NUMBER(11,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 125 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"EMAIL" NVARCHAR2(100), 
	"PASSWORD" NVARCHAR2(255), 
	"CARNET_IDENTIDAD" NVARCHAR2(20), 
	"NOMBRES" NVARCHAR2(100), 
	"APELLIDOS" NVARCHAR2(100), 
	"ROL" NVARCHAR2(20), 
	"FECHA_REGISTRO" DATE NOT NULL ENABLE, 
	"FECHA_NACIMIENTO" DATE, 
	"DIRECCION" NVARCHAR2(200), 
	"TELEFONO" NVARCHAR2(100), 
	 UNIQUE ("EMAIL")
  USING INDEX  ENABLE, 
	 PRIMARY KEY ("ID_USUARIO")
  USING INDEX  ENABLE, 
	 UNIQUE ("CARNET_IDENTIDAD")
  USING INDEX  ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."GRADO" 
   (	"ID_GRADO" NUMBER(11,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 13 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"NOMBRE" NVARCHAR2(50), 
	"NIVEL_JERARQUICO" NUMBER(11,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID_GRADO")
  USING INDEX  ENABLE, 
	 UNIQUE ("NOMBRE")
  USING INDEX  ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."TUTOR" 
   (	"ID_USUARIO" NUMBER(11,0) NOT NULL ENABLE, 
	"CODIGO_VINCULACION" NVARCHAR2(20), 
	"DIRECCION_DOMICILIO" VARCHAR2(255), 
	"TELEFONO_EMERGENCIA" VARCHAR2(50), 
	 UNIQUE ("CODIGO_VINCULACION")
  USING INDEX  ENABLE, 
	 PRIMARY KEY ("ID_USUARIO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "TUTOR_ID_USUARI_48B3A8E5_F" FOREIGN KEY ("ID_USUARIO")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."PROFESOR" 
   (	"ID_USUARIO" NUMBER(11,0) NOT NULL ENABLE, 
	"ESPECIALIDAD" NVARCHAR2(100), 
	"GRADO_ACADEMICO" VARCHAR2(100), 
	 PRIMARY KEY ("ID_USUARIO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PROFESOR_ID_USUARI_5691F711_F" FOREIGN KEY ("ID_USUARIO")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."ESTUDIANTE" 
   (	"ID_USUARIO" NUMBER(11,0) NOT NULL ENABLE, 
	"DATOS_MEDICOS" NVARCHAR2(200), 
	"ID_GRADO" NUMBER(11,0), 
	"ID_TUTOR" NUMBER(11,0), 
	 PRIMARY KEY ("ID_USUARIO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ESTUDIANT_ID_GRADO_CF443431_F" FOREIGN KEY ("ID_GRADO")
	  REFERENCES "SYSTEM"."GRADO" ("ID_GRADO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "ESTUDIANT_ID_TUTOR_A56621CD_F" FOREIGN KEY ("ID_TUTOR")
	  REFERENCES "SYSTEM"."TUTOR" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "ESTUDIANT_ID_USUARI_A8BCB9D6_F" FOREIGN KEY ("ID_USUARIO")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."MATERIA" 
   (	"ID_MATERIA" NUMBER(11,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 6 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"NOMBRE" NVARCHAR2(100), 
	 UNIQUE ("NOMBRE")
  USING INDEX  ENABLE, 
	 PRIMARY KEY ("ID_MATERIA")
  USING INDEX  ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."LIBRO" 
   (	"ID_LIBRO" NUMBER(11,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 2 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"TITULO" NVARCHAR2(200), 
	"AUTOR" NVARCHAR2(200), 
	"DESCRIPCION" NCLOB, 
	"FECHA_PUBLICACION" DATE, 
	"ARCHIVO_PDF" NVARCHAR2(100), 
	"TIEMPO_ESTIMADO" NUMBER(11,0) NOT NULL ENABLE, 
	"CREATED_AT" TIMESTAMP (6) NOT NULL ENABLE, 
	"ID_GRADO" NUMBER(11,0), 
	"ID_USUARIO_SUBIO" NUMBER, 
	"ID_MATERIA" NUMBER, 
	"PORTADA" NVARCHAR2(100), 
	 PRIMARY KEY ("ID_LIBRO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "LIBRO_ID_GRADO_71D2866E_F" FOREIGN KEY ("ID_GRADO")
	  REFERENCES "SYSTEM"."GRADO" ("ID_GRADO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "FK_LIBRO_SUBIO" FOREIGN KEY ("ID_USUARIO_SUBIO")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") ENABLE, 
	 CONSTRAINT "FK_LIBRO_MATERIA" FOREIGN KEY ("ID_MATERIA")
	  REFERENCES "SYSTEM"."MATERIA" ("ID_MATERIA") ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."ASIGNACION" 
   (	"ID" NUMBER(19,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 62 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ESTADO" NVARCHAR2(20), 
	"CREATED_AT" TIMESTAMP (6) NOT NULL ENABLE, 
	"ID_ESTUDIANTE" NUMBER(11,0) NOT NULL ENABLE, 
	"ID_PROFESOR" NUMBER(11,0) NOT NULL ENABLE, 
	"ID_LIBRO" NUMBER(11,0) NOT NULL ENABLE, 
	"ID_MATERIA" NUMBER(11,0), 
	"DESCRIPCION" VARCHAR2(255), 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ASIGNACIO_ID_ESTUDI_EF058DBE_F" FOREIGN KEY ("ID_ESTUDIANTE")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "ASIGNACIO_ID_MATERI_01DEDBED_F" FOREIGN KEY ("ID_MATERIA")
	  REFERENCES "SYSTEM"."MATERIA" ("ID_MATERIA") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "ASIGNACIO_ID_PROFES_391BF51A_F" FOREIGN KEY ("ID_PROFESOR")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "ASIGNACIO_ID_LIBRO_884E018E_F" FOREIGN KEY ("ID_LIBRO")
	  REFERENCES "SYSTEM"."LIBRO" ("ID_LIBRO") DEFERRABLE INITIALLY DEFERRED ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."LEE" 
   (	"ID" NUMBER(19,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 24 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"FECHA_INICIO" TIMESTAMP (6) NOT NULL ENABLE, 
	"TIEMPO_LEIDO_SEGUNDOS" NUMBER(11,0) NOT NULL ENABLE, 
	"ID_ESTUDIANTE" NUMBER(11,0) NOT NULL ENABLE, 
	"ID_LIBRO" NUMBER(11,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "LEE_ID_LIBRO_033A07EF_F" FOREIGN KEY ("ID_LIBRO")
	  REFERENCES "SYSTEM"."LIBRO" ("ID_LIBRO") DEFERRABLE INITIALLY DEFERRED ENABLE, 
	 CONSTRAINT "LEE_ID_ESTUDI_2DE71AB2_F" FOREIGN KEY ("ID_ESTUDIANTE")
	  REFERENCES "SYSTEM"."USUARIO" ("ID_USUARIO") DEFERRABLE INITIALLY DEFERRED ENABLE
   ) ;


  CREATE TABLE "SYSTEM"."DESCARGA" 
   (	"ID_DESCARGA" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ID_USUARIO" NUMBER, 
	"ID_LIBRO" NUMBER, 
	"FECHA_HORA" DATE DEFAULT SYSDATE, 
	"IP_USUARIO" VARCHAR2(45), 
	 PRIMARY KEY ("ID_DESCARGA")
  USING INDEX  ENABLE
   ) ;

-- 3. INSERCIÓN DE DATOS
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (1, 'admin@neoteca.com', '58B5444CF1B6253A4317FE12DAFF411A78BDA0A95279B1D5768EBF5CA60829E78DA944E8A9160A0B6D428CB213E813525A72650DAC67B88879394FF624DA482F', '6464645', 'Jimmy', 'Urinated', 'ADMIN', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2003-11-22 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'MI Casa', '5456456');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (2, 'tutor2@neoteca.com', '94A2F351E6415A05CB07631EAA063EE6BAD57C643E715142A0140ED0FE421D28EA8A64581B05FC7C872C6041CECE576BC4AA01B60EA46DAD368D92239C4C95A5', '78452358745', 'Cross', 'Neo', 'TUTOR', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('1999-02-15 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Casa Aesthetic', '78451254687');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (3, 'ana@neoteca.com', 'C710358C4194EBF43C09B03DE4576162A045B6A7E8D76C93B6F431B25FBB6037D8CDAC666B24F4D610865764526D4BE3F6CFA90F635BAE95C417DE3F87BB0656', '56486543', 'Ana', 'Neo', 'ESTUDIANTE', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-03-14 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Casa Astehetic', '56456465');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (4, 'profe@neoteca.com', 'FEA631FBABDEABC86354BB3BE07BF508E0269492CAC38ED07CB9395DF4910BCBA82A909ABD93C4CA2C44472EF7B669BAD8B6B8765148A6733AAAAF958F6E6FDC', '56465456', 'DReam', 'Gomez', 'PROFESOR', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('1998-06-02 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Casa backroom', '7897465');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (21, 'mariatutor@neoteca.com', '8D99FB95A2AEE7491D988F6279C878F8BCC7130102B1CB8D27430A673546786E8D0BDB22D6E609B679C26D9521BE886377F2DA038827329126F54E48A3AAB11B', '46548456', 'Maria', 'Cocche', 'TUTOR', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, 'Maria Casa', '456465');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (10, 'tutor1@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '1001', 'Carlos', 'Mamani', 'TUTOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (11, 'tutor2@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '1002', 'Maria', 'Flores', 'TUTOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (12, 'tutor3@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '1003', 'Pedro', 'Quispe', 'TUTOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (13, 'tutor4@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '1004', 'Ana', 'Vargas', 'TUTOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (14, 'tutor5@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '1005', 'Luis', 'Choque', 'TUTOR', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (20, 'profe1@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '2001', 'Roberto', 'Gomez', 'PROFESOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (22, 'profe3@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '2003', 'Javier', 'Soto', 'PROFESOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (23, 'profe4@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '2004', 'Elena', 'Rojas', 'PROFESOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (24, 'profe5@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '2005', 'Marco', 'Paz', 'PROFESOR', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (30, 'est1@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '3001', 'Pepito', 'Mamani', 'ESTUDIANTE', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (31, 'est2@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '3002', 'Juanito', 'Mamani', 'ESTUDIANTE', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (32, 'est3@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '3003', 'Lucia', 'Flores', 'ESTUDIANTE', TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (33, 'est4@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '3004', 'Mateo', 'Quispe', 'ESTUDIANTE', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (34, 'est5@test.com', '3C9909AFEC25354D551DAE21590BB26E38D53F2173B8D3DC3EEE4C047E7AB1C1EB8B85103E3BE7BA613B31BB5C9C36214DC9F14A42FD7A2FDB84856BCA5C44C2', '3005', 'Carla', 'Vargas', 'ESTUDIANTE', TO_DATE('2025-12-03 03:49:36', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (120, 'felipetutor@neoteca.com', 'F4815935C2E0BEE8D581E59CDD8926E926E726EF5EE8E7C8BADC47B39988E3A50CFC5CA36A2E80AE2836D1C8B91184460CA281114E097C8DF793D8436F72C1F3', '232131231', 'Felipe', 'Quispe', 'TUTOR', TO_DATE('2025-12-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, 'Zona Tejar', '4564564');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (121, 'leotutor@neoteca.com', 'AA1327D93C6C26DC03C3E6FF680BD1A55AF1D2F300E29963BE175303229BE50E75ABEB629348D39ED996826C0D942A3D23800CDB3B1CBAEF6C3F324C540F5F81', '289137891', 'Leonardo', 'Mamani', 'TUTOR', TO_DATE('2025-12-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, 'Miraflores', '1298198');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (122, 'mafalda@neoteca.com', '7B18F4C3F33A99120B41633332B6D392C4551FA237CB5252789C0EFA04C1A8DBF43CEA4C03555909E9A1F011325BAA5900E71B786578F88D7297EAF604364E45', '13981903', 'Mafalda', 'Ramirez', 'ESTUDIANTE', TO_DATE('2025-12-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (123, 'lourdes@neoteca.com', 'lourdes1', '2131298', 'Lourdes', 'Chura', 'PROFESOR', TO_DATE('2025-12-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2005-02-14 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Achocalla', '2310293');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (124, 'manolito@neoteca.com', '47E96F4AFF3D68396FD57921B7FFAFDAEB994408D5A3F5DDAA3E9F99D775678E7F87A8915AEFFFA42CA74D0E247D2E6D4B5A3A903141107E959DB6FCEB40A36A', '121313124', 'Manolito', 'Quispe', 'ESTUDIANTE', TO_DATE('2025-12-07 17:36:42', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (125, 'director_prueba@neoteca.com', 'prueba123', '2103901', 'Prueba', 'Preuba', 'ADMIN', TO_DATE('2025-12-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2025-12-17 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Mi cas', '921039');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (145, 'daniel@gmail.com', '8AE1B615110CB8432342FC64506C721175C0ED56FCA1ACB6A0FD119DE7C4D6E99A52CCEB477D9049FE800C5A34F801087EB45253AEB7F01C6527CE387E2A5032', '12345678', 'daniel', 'silvestre', 'TUTOR', TO_DATE('2025-12-08 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), NULL, 'mi_casa', '12345678');
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (146, 'benjamin@gmail.com', '413CF218E0ED8D27B2BB0E0AD17A2507E27167B693C0D455F87DD9A60A62A072E652E1790DA68BA713A04A21ADB080BF9D02238DD15AF7D03A00EF0C81038FC2', '451655', 'amilcar', 'quispe', 'ESTUDIANTE', TO_DATE('2025-12-08 22:47:43', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);
INSERT INTO USUARIO (ID_USUARIO, EMAIL, PASSWORD, CARNET_IDENTIDAD, NOMBRES, APELLIDOS, ROL, FECHA_REGISTRO, FECHA_NACIMIENTO, DIRECCION, TELEFONO) VALUES (153, 'anakilla@neoteca.com', '0DAAE054CC048045750883E488B6B90A7538F6408251DC63CD0A9148D5D633BF2530FA54E871DC512AF4233057DCADFFA9C54C82D54420CA10311DD9AF68F965', '2387489274', 'Ana', 'Killa', 'ESTUDIANTE', TO_DATE('2025-12-08 23:19:48', 'YYYY-MM-DD HH24:MI:SS'), NULL, NULL, NULL);

INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (1, '1ro Primaria', 1);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (2, '2do de Primaria', 2);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (3, '3ro de Primaria', 3);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (4, '4to de Primaria', 4);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (5, '5to de Primaria', 5);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (6, '6to de Primaria', 6);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (7, '1ro de Secundaria', 7);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (8, '2do de Secundaria', 8);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (9, '3ro de Secundaria', 9);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (10, '4to de Secundaria', 10);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (11, '5to de Secundaria', 11);
INSERT INTO GRADO (ID_GRADO, NOMBRE, NIVEL_JERARQUICO) VALUES (12, 'Promo (6to Sec)', 12);

INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (2, 'TUT-0001', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (10, 'TUT-8909', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (11, 'TUT-0909', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (12, 'TUT-9990', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (13, 'TUT-0005', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (121, 'TUT-9091', NULL, NULL);
INSERT INTO TUTOR (ID_USUARIO, CODIGO_VINCULACION, DIRECCION_DOMICILIO, TELEFONO_EMERGENCIA) VALUES (145, 'TUT-0797', NULL, NULL);

INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (4, 'Matematicas', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (20, 'Literatura', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (21, 'Historia', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (22, 'Ciencias', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (23, 'Lenguaje', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (24, 'C��vica', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (32, NULL, 'jhjk');
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (122, 'H', NULL);
INSERT INTO PROFESOR (ID_USUARIO, ESPECIALIDAD, GRADO_ACADEMICO) VALUES (123, 'Matematicas', 'Licenciatra');

INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (3, 'NInguno', 1, 2);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (30, NULL, 1, 10);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (31, NULL, 5, 10);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (32, NULL, 7, 11);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (33, NULL, 12, 12);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (34, NULL, 8, 13);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (122, NULL, 8, 121);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (123, 'lk', NULL, NULL);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (124, NULL, 3, 121);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (146, NULL, 7, 145);
INSERT INTO ESTUDIANTE (ID_USUARIO, DATOS_MEDICOS, ID_GRADO, ID_TUTOR) VALUES (153, NULL, 2, 121);

INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (1, 'Lenguaje');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (2, 'Historia');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (3, 'Ciencias');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (5, 'Civica');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (6, 'Artes');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (7, 'Fisica');
INSERT INTO MATERIA (ID_MATERIA, NOMBRE) VALUES (8, 'Psicologia');

INSERT INTO LIBRO (ID_LIBRO, TITULO, AUTOR, DESCRIPCION, FECHA_PUBLICACION, ARCHIVO_PDF, TIEMPO_ESTIMADO, CREATED_AT, ID_GRADO, ID_USUARIO_SUBIO, ID_MATERIA, PORTADA) VALUES (1, 'blanca nieves y rosa roja', 'Hermanos Grimm', Una pobre mujer vivía en una cabaña en medio del campo; en un huerto
situado delante de la puerta, había dos rosales, uno de los cuales daba
rosas blancas y el otro rosas encarnadas...., TO_DATE('2025-12-03 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'libros/archivos/Hermanos_Grimm_-_Blancanieve_y_Rojarosa.pdf', 16, TO_DATE('2025-12-03 00:46:40', 'YYYY-MM-DD HH24:MI:SS'), 1, NULL, 1, 'libros/portadas/blancanieeveyrosaroja.jpeg');
INSERT INTO LIBRO (ID_LIBRO, TITULO, AUTOR, DESCRIPCION, FECHA_PUBLICACION, ARCHIVO_PDF, TIEMPO_ESTIMADO, CREATED_AT, ID_GRADO, ID_USUARIO_SUBIO, ID_MATERIA, PORTADA) VALUES (2, 'Artes Plasticas y VIsuales', 'MInisterio de Educacion', Libro de artes PLasticas, NULL, 'libros/archivos/1er_año_de_escolaridad_-_Artes_Plásticas_y_Visuales_2025.pdf', 40, TO_DATE('2025-12-08 22:28:59', 'YYYY-MM-DD HH24:MI:SS'), 1, 1, NULL, NULL);
INSERT INTO LIBRO (ID_LIBRO, TITULO, AUTOR, DESCRIPCION, FECHA_PUBLICACION, ARCHIVO_PDF, TIEMPO_ESTIMADO, CREATED_AT, ID_GRADO, ID_USUARIO_SUBIO, ID_MATERIA, PORTADA) VALUES (3, 'Lengua Extranjera', 'MInisterio de Educacion', LIBRO DE INGLES, NULL, 'libros/archivos/1er_año_de_escolaridad_-_Lengua_Extranjera_Inglés_2025.pdf', 50, TO_DATE('2025-12-08 22:31:03', 'YYYY-MM-DD HH24:MI:SS'), 1, 1, NULL, NULL);

INSERT INTO ASIGNACION (ID, ESTADO, CREATED_AT, ID_ESTUDIANTE, ID_PROFESOR, ID_LIBRO, ID_MATERIA, DESCRIPCION) VALUES (84, 'COMPLETADO', TO_DATE('2025-12-08 22:50:19', 'YYYY-MM-DD HH24:MI:SS'), 122, 4, 2, 6, NULL);
INSERT INTO ASIGNACION (ID, ESTADO, CREATED_AT, ID_ESTUDIANTE, ID_PROFESOR, ID_LIBRO, ID_MATERIA, DESCRIPCION) VALUES (85, 'PENDIENTE', TO_DATE('2025-12-08 23:03:15', 'YYYY-MM-DD HH24:MI:SS'), 3, 4, 1, NULL, 'leer');
INSERT INTO ASIGNACION (ID, ESTADO, CREATED_AT, ID_ESTUDIANTE, ID_PROFESOR, ID_LIBRO, ID_MATERIA, DESCRIPCION) VALUES (82, 'PENDIENTE', TO_DATE('2025-12-08 22:49:17', 'YYYY-MM-DD HH24:MI:SS'), 3, 4, 3, NULL, 'resumen');
INSERT INTO ASIGNACION (ID, ESTADO, CREATED_AT, ID_ESTUDIANTE, ID_PROFESOR, ID_LIBRO, ID_MATERIA, DESCRIPCION) VALUES (83, 'PENDIENTE', TO_DATE('2025-12-08 22:49:17', 'YYYY-MM-DD HH24:MI:SS'), 30, 4, 3, NULL, 'resumen');
INSERT INTO ASIGNACION (ID, ESTADO, CREATED_AT, ID_ESTUDIANTE, ID_PROFESOR, ID_LIBRO, ID_MATERIA, DESCRIPCION) VALUES (86, 'PENDIENTE', TO_DATE('2025-12-08 23:03:15', 'YYYY-MM-DD HH24:MI:SS'), 30, 4, 1, NULL, 'leer');

INSERT INTO LEE (ID, FECHA_INICIO, TIEMPO_LEIDO_SEGUNDOS, ID_ESTUDIANTE, ID_LIBRO) VALUES (1, TO_DATE('2025-12-03 01:05:04', 'YYYY-MM-DD HH24:MI:SS'), 358, 3, 1);
INSERT INTO LEE (ID, FECHA_INICIO, TIEMPO_LEIDO_SEGUNDOS, ID_ESTUDIANTE, ID_LIBRO) VALUES (2, TO_DATE('2025-12-03 01:06:21', 'YYYY-MM-DD HH24:MI:SS'), 88, 1, 1);
INSERT INTO LEE (ID, FECHA_INICIO, TIEMPO_LEIDO_SEGUNDOS, ID_ESTUDIANTE, ID_LIBRO) VALUES (23, TO_DATE('2025-12-07 15:56:58', 'YYYY-MM-DD HH24:MI:SS'), 39, 122, 1);
INSERT INTO LEE (ID, FECHA_INICIO, TIEMPO_LEIDO_SEGUNDOS, ID_ESTUDIANTE, ID_LIBRO) VALUES (24, TO_DATE('2025-12-08 22:50:41', 'YYYY-MM-DD HH24:MI:SS'), 1144, 122, 2);


COMMIT;

-- 4. OBJETOS PL/SQL (Procedimientos, Funciones, Triggers, Vistas)

  CREATE OR REPLACE NONEDITIONABLE PROCEDURE "SYSTEM"."CREAR_USUARIO_SEGURO" (
    p_email IN VARCHAR2,
    p_pass IN VARCHAR2,
    p_nombres IN VARCHAR2,
    p_apellidos IN VARCHAR2,
    p_rol IN VARCHAR2,
    p_carnet IN VARCHAR2
) IS
BEGIN
    INSERT INTO USUARIO (email, password, nombres, apellidos, rol, carnet_identidad, fecha_registro)
    VALUES (
        p_email,
        f_hash_seguro(p_pass),
        p_nombres,
        p_apellidos,
        p_rol,
        p_carnet,
        SYSDATE
    );
    COMMIT;
END;
/


  CREATE OR REPLACE NONEDITIONABLE PROCEDURE "SYSTEM"."ASIGNAR_TAREA_GRADO" (
    p_id_profesor NUMBER, p_id_libro NUMBER, p_id_grado NUMBER, p_desc VARCHAR2
) AS
BEGIN
    INSERT INTO ASIGNACION (id_profesor, id_estudiante, id_libro, descripcion, estado, created_at)
    SELECT p_id_profesor, e.id_usuario, p_id_libro, p_desc, 'PENDIENTE', SYSDATE
    FROM ESTUDIANTE e WHERE e.id_grado = p_id_grado;
    COMMIT;
END;
/


  CREATE OR REPLACE NONEDITIONABLE PROCEDURE "SYSTEM"."PROMOVER_ESTUDIANTE" (p_id_estudiante NUMBER) AS
BEGIN
    UPDATE ESTUDIANTE SET id_grado = id_grado + 1 WHERE id_usuario = p_id_estudiante;
    COMMIT;
END;
/


  CREATE OR REPLACE NONEDITIONABLE FUNCTION "SYSTEM"."VERIFICAR_LOGIN" (
    p_email IN VARCHAR2,
    p_pass  IN VARCHAR2
) RETURN VARCHAR2 IS
    v_rol VARCHAR2(20);
    v_pass_hash VARCHAR2(255);
BEGIN
    -- Generamos el hash de la contrase��a que ingresa el usuario
    v_pass_hash := f_hash_seguro(p_pass);

    -- Buscamos si existe el usuario con ese email y ESE hash
    SELECT rol
    INTO v_rol
    FROM USUARIO
    WHERE email = p_email
      AND password = v_pass_hash;

    RETURN v_rol;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN NULL;
END;
/


  CREATE OR REPLACE NONEDITIONABLE FUNCTION "SYSTEM"."F_HASH_SEGURO" (p_texto VARCHAR2) RETURN VARCHAR2 IS
    v_hash_raw RAW(2000);
BEGIN
    IF p_texto IS NULL THEN RETURN NULL; END IF;

    -- Correcci��n: Usamos SQL para llamar a STANDARD_HASH
    SELECT STANDARD_HASH(p_texto, 'SHA512')
    INTO v_hash_raw
    FROM DUAL;

    RETURN RAWTOHEX(v_hash_raw);
END;
/


  CREATE OR REPLACE NONEDITIONABLE TRIGGER "SYSTEM"."TRG_NO_LEER_MADRUGADA" 
BEFORE INSERT ON LEE
FOR EACH ROW
BEGIN
    IF TO_CHAR(SYSDATE, 'HH24') IN ('03', '04') THEN
        RAISE_APPLICATION_ERROR(-20013, 'El sistema descansa de 03:00 a 05:00 AM.');
    END IF;
END;

ALTER TRIGGER "SYSTEM"."TRG_NO_LEER_MADRUGADA" ENABLE
/

